<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>图片爬虫一键启动</title>
  <style>
    body { font-family: sans-serif; max-width: 600px; margin: 40px auto; }
    label { display: block; margin: 12px 0 4px; }
    input { width: 100%; padding: 8px; }
    button { margin-top: 20px; padding: 10px 20px; }
  </style>
</head>
<body>
  <h1>图片爬虫 & 自动标注</h1>

  <label>关键词</label>
  <input id="keyword" value="cat" />

  <label>最大张数</label>
  <input id="num_img" type="number" value="10" />

  <button id="runBtn">开始抓取并打包下载</button>

  <script>
    const WEBHOOK_URL = 'http://localhost:5678/webhook-test/run-scraper';

    document.getElementById('runBtn').onclick = async () => {
      const body = {
        keyword: document.getElementById('keyword').value,
        num_img: Number(document.getElementById('num_img').value)
      };
      const resp = await fetch(WEBHOOK_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(body)
      });

      if (!resp.ok) {
        alert('执行失败: ' + (await resp.text()));
        return;
      }

      // 浏览器下载 zip
      const blob = await resp.blob();
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `result_${body.keyword}.zip`;
      a.click();
      URL.revokeObjectURL(url);
    };
  </script>
</body>
</html>